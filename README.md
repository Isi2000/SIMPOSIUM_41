# NOTE: THIS IS STILL HEAVILY GENERATED BY AI, I'VE FIXED A FEW THINGS, BUT STILL I DO NOT CONSIDER IT GOOD BY ANY MEANS

# Higher-Order Singular Value Decomposition for Hydrogen Jet Combustion Analysis

## Overview

The focus of the work is now comparing HOSVD to PCA in combustion. The methodology decomposes multi-dimensional combustion data into orthogonal modes that capture spatial patterns, temporal evolution, and chemical species interactions. 

## Research Objectives

- Extract dominant spatial, temporal, and chemical modes from combustion simulation data
- Compare chemical mode structures obtained by HOSVD and PCA (Parente's paper's methodology)
- Compare mode structures across different flow conditions (Reynolds numbers)
- Analyze frequency content of temporal dynamics in chemical evolution
- Quantify relative importance of chemical species in different decomposition modes

## Methodology

### 1. Data Acquisition
Data is taken from BLASTNET at the following link:
https://blastnet.github.io/diluted_partially_premixed_h2air_lifted_flame

This is a Direct Numerical Simulation (DNS) data of hydrogen jet under multiple conditions, the ones currently analyzed are:

- **Reacting flows**: Reynolds numbers Re = 5,000 and Re = 10,000
- **Non-reacting flows**: Reynolds numbers Re = 5,000 and Re = 10,000

Each simulation provides:
- Spatial resolution: 1600 × 2000 grid points
- Temporal snapshots: 200 time steps
- Chemical species: 8 tracked species (H, H₂, O, O₂, OH, H₂O, HO₂, H₂O₂)

### 2. Data Preprocessing

#### Spatial Subsampling
In order to have the code run fast and test without losing too much time transfering everything on CESVIMA, the data is reduced heavily.

- Original grid: 1600 × 2000 points
- Subsampled grid: 200 × 160 points (10× reduction in each direction)

#### Mass to Molar Fraction Conversion

Mass fractions are converted to molar fractions by dividing by species-specific molar masses, I wanna whatch the chemistry process, so I want moles. If I keep mass concentration the prevalent modes are not the species which are most involved in chemical reactions, but the heavier ones (learned this at my own expense :( )


#### Data Normalization

Regarding this I still have some light doubts, I need to better understand the best way to do this. Unfortunately the scaling of variables greatly affect the shape of the chemical modes.
- Prevents dominance by species with large absolute values
- Ensures all species contribute appropriately to the decomposition
- Maintains relative spatial and temporal variations

##### Outlier Detection
Never super wrong, particularly important if I scale by the max value.
Interquartile Range (IQR) method applied to each species:
- Lower bound: Q1 - 3×IQR
- Upper bound: Q3 + 3×IQR
- Identifies extreme values (typically 8-23% of data points per species)
- Provides quality assessment without removing data

### 3. Tensor Construction

A 4-dimensional tensor **T** is constructed with dimensions:

**T** ∈ ℝ^(Nx × Ny × Nc × Nt)

Where:
- **Nx** = 200 (spatial dimension, streamwise direction)
- **Ny** = 160 (spatial dimension, cross-stream direction)
- **Nc** = 8 (chemical species)
- **Nt** = 200 (time snapshots)

This tensor captures:
- Spatial distribution of chemical species
- Temporal evolution of combustion process
- Coupling between different chemical species

### 4. HOSVD Decomposition

The Higher-Order SVD (Tucker decomposition) factorizes the tensor as:

**T** ≈ **G** ×₁ **U**^(x) ×₂ **U**^(y) ×₃ **U**^(chem) ×₄ **U**^(time)

Where:
- **G** is the core tensor containing mode interactions
- **U**^(x) ∈ ℝ^(Nx × Nx): Spatial modes (streamwise)
- **U**^(y) ∈ ℝ^(Ny × Ny): Spatial modes (cross-stream)
- **U**^(chem) ∈ ℝ^(Nc × Nc): Chemical species modes
- **U**^(time) ∈ ℝ^(Nt × Nt): Temporal modes

#### Decomposition Algorithm

For each mode n ∈ {0, 1, 2, 3}:
1. Unfold tensor along mode n: **T**_(n)
2. Compute SVD: **T**_(n) = **U**_(n) **Σ**_(n) **V**_(n)^T
3. Extract left singular vectors as mode matrix **U**^(n)

The core tensor is then computed:
**G** = **T** ×₁ (**U**^(x))^T ×₂ (**U**^(y))^T ×₃ (**U**^(chem))^T ×₄ (**U**^(time))^T

#### Reconstruction Accuracy

I am using the full tensor since I don't wanna compress anything, my goal is to study patterns.  So, the full reconstruction achieves machine precision:
- Relative reconstruction error: O(10^-15)
- Confirms orthogonality of mode bases

### 5. Analysis Methods

#### Singular Value Analysis

Core tensor singular values are computed along each dimension by taking Frobenius norms:

- **Spatial modes (X)**: σᵢ^(x) = ||**G**(i, :, :, :)||_F
- **Spatial modes (Y)**: σⱼ^(y) = ||**G**(:, j, :, :)||_F
- **Chemical modes**: σₖ^(chem) = ||**G**(:, :, k, :)||_F
- **Temporal modes**: σₗ^(time) = ||**G**(:, :, :, l)||_F

These reveal:
- Energy content of each mode
- Relative importance for dimensional reduction
- Decay rates indicating intrinsic dimensionality

#### Chemical Mode Interpretation

For each chemical mode k, analyze the composition vector **U**^(chem)(:, k):
- Relative contribution of each species
- Dominant species identification
- Physical interpretation of coupled chemistry


#### Temporal Frequency Analysis

For each chemical mode, temporal dynamics are analyzed:

1. Reconstruct data using single chemical mode k
2. Unfold along temporal dimension
3. Compute SVD to extract temporal modes
4. Apply Fast Fourier Transform (FFT) to temporal mode vectors
5. Compute Power Spectral Density (PSD)

This reveals:
- Characteristic frequencies of combustion dynamics
- Periodic vs. aperiodic behavior
- Modal energy distribution across frequencies

Sampling parameters:
- Time step: Δt = 5 × 10^-6 s
- Nyquist frequency: 100 kHz
- Number of temporal modes analyzed: 10

#### Spatial Reconstruction

Single-mode reconstructions isolate contributions:

**T**_k = **G** ×₁ **U**^(x) ×₂ **U**^(y) ×₃ **u**_k^(chem) ×₄ **U**^(time)

Where **u**_k^(chem) is the k-th chemical mode vector.

Visualizations show:
- Spatial structure associated with each chemical phenomenon
- Separation of fuel, oxidizer, and product regions
- Reaction zone identification
- Turbulent mixing patterns

### 6. Comparative Analysis

The methodology enables comparison across flow conditions:

#### Reynolds Number Effects
- Mode energy distribution differences
- Spatial structure variations
- Temporal frequency shifts

#### Reacting vs. Non-Reacting Flows
- Presence of product species modes (H₂O, OH)
- Reaction zone features
- Chemical coupling patterns

## Key Findings and Insights

### Mode Hierarchy

Chemical modes exhibit clear physical interpretation:
1. **Fuel mode** (H₂): Identifies injection and mixing regions
2. **Oxidizer mode** (O₂): Captures ambient air entrainment
3. **Product mode** (H₂O): Shows combustion completeness
4. **Radical modes** (OH, O, H): Indicate reaction zones

### Dimensional Reduction Potential

Singular value decay rates indicate:
- Spatial modes: Rapid decay suggests low-dimensional spatial structure
- Chemical modes: First 3-4 modes contain >95% of information
- Temporal modes: Power-law decay for reacting cases

### Physical Interpretation

The HOSVD framework successfully separates:
- **Spatial organization**: Jet structure, mixing layers, recirculation
- **Chemical composition**: Species segregation and mixing
- **Temporal dynamics**: Convection, diffusion, reaction timescales

## Computational Considerations

### Memory Requirements
- Full tensor: ~390 MB per dataset (single precision)
- Factor matrices: ~2 MB total
- Core tensor: ~390 MB (full-rank case)

### Computational Complexity
- HOSVD decomposition: O(n⁴) for 4D tensor
- Processing time: ~16 seconds for reacting flows, ~2 seconds for non-reacting

### Storage
Decomposed representations stored in HDF5 format:
- Core tensor and factor matrices
- Enables efficient loading for analysis
- Facilitates sharing and reproducibility

## Applications and Extensions

## References and Data Sources

### Datasets
- Kaggle Hub: Hydrogen Jet Simulation Collections
  - sharmapushan/hydrogen-jet-5000
  - sharmapushan/hydrogen-jet-10000
  - sharmapushan/nonreacting-hydrogen-jet-5000
  - sharmapushan/nonreacting-hydrogen-jet-10000

### Software Libraries
- **TensorLy**: Python library for tensor decomposition
- **NumPy**: Numerical computations
- **SciPy**: FFT and signal processing
- **h5py**: HDF5 file format for data storage

## Repository Structure

```
SIMPOSIUM_41/
├── comparative_hosvd.ipynb          # HOSVD decomposition workflow
├── results_analysis.ipynb           # Mode analysis and visualization
├── HOSVD_DECOMPOSITIONS/            # Stored decomposition results
└── HOSVD_DECOMPOSITION_MEAN_SCALED/ # Alternative scaling results
```

## Contact and Citation

For questions about the methodology or to cite this work, please refer to the associated publication or contact the authors through the repository.

---

**Last Updated**:31 October 2024
